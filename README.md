# Coursework_Data_Base
Курсовая работа по созданию базы данных содержащих информацию о вакансиях и работодателях.

## main
### Функция
#### user_interaction
* Функция для взаимодействия с пользователем.

## src.api_hh
### Функции
#### get_employer_vacancies
* Получает все вакансии работодателя со всех страниц.

        Параметры:
        employer_id (int): ID работодателя

        Возвращаемое значение:
        List[Dict[str, Any]]: список словарей с информацией о вакансиях
                                                                                                                                                                                                                                   
        Поднимает:                                                                                                                                                                                                                 
        requests.RequestException: при ошибке запроса                                                                                                                                                                              
                                                                                                                                                                                                                                   
#### get_employers_info                                                                                                                                                               
* Получает информацию о работодателе по его ID.                                                                                                                                                                              
                                                                                                                                                                                                                                   
        Параметры:                                                                                                                                                                                                                 
        employer_id (int): ID работодателя                                                                                                                                                                                         
                                                                                                                                                                                                                                   
        Возвращаемое значение:                                                                                                                                                                                                     
        Dict[str, Any]: словарь с информацией о работодателе или None при ошибке                                                                                                                                                   
                                                                                                                                                                                                                                   
        Поднимает:                                                                                                                                                                                                                 
        requests.RequestException: при ошибке запроса                                                                                                                                                                              
                                                                                                                                                                                                                                   
#### get_vacancies_info
* Получает информацию о вакансиях работодателя.                                                                                                                                                                              
                                                                                                                                                                                                                                   
        Параметры:                                                                                                                                                                                                                 
        employer_id (int): ID работодателя                                                                                                                                                                                         
        page (int): номер страницы с вакансиями (по умолчанию 0)                                                                                                                                                                   
                                                                                                                                                                                                                                   
        Возвращаемое значение:                                                                                                                                                                                                     
        Dict[str, Any]: словарь с информацией о вакансиях или None при ошибке                                                                                                                                                      
                                                                                                                                                                                                                                   
        Поднимает:                                                                                                                                                                                                                 
        requests.RequestException: при ошибке запроса                                                                                                                                                                              
        ValueError: при ошибке парсинга JSON                                                                                                                                                                                       
                                                          
## src.db_setup
### Функции
#### create_database_if_not_exists
* Функция для создания базы данных в случае её отсутствия.

        Параметры:                                                                                                                                                                                                                 
        db_name (str): имя создаваемой базы данных                                                                                                                                                                                 
        user (str): имя пользователя базы данных                                                                                                                                                                                   
        password (str): пароль от базы данных                                                                                                                                                                                      
        host (str, optional): хост, по умолчанию '127.0.0.1'                                                                                                                                                                       
        port (str, optional): номер порта, по умолчанию '5432'                                                                                                                                                                     
                                                                                                                                                                                                                                   
        Возвращаемое значение:                                                                                                                                                                                                     
        None                                                                                                                                                                                                                       
                                                                                                                                                                                                                                   
        Побочные эффекты:                                                                                                                                                                                                          
        - Создает базу данных с заданным именем, если она не существует                                                                                                                                                            
        - Выводит сообщение об успешном создании или обновлении                                                                                                                                                                    
        - Обрабатывает возможные ошибки подключения и создания                                                                                                                                                                     
                                                                                                                                                                                                                                   
        Поднимает:                                                                                                                                                                                                                 
        Exception: при возникновении ошибок подключения или создания базы данных                                                                                                                                                   
                                                                                                                                                                                                                                   
#### create_table_if_not_exists
* Создает таблицу в базе данных, если она еще не существует.                                                                                                                                                                 
                                                                                                                                                                                                                                   
        Параметры:                                                                                                                                                                                                                 
        dbname (str): название базы данных                                                                                                                                                                                         
        user (str): имя пользователя для подключения                                                                                                                                                                               
        password (str): пароль пользователя                                                                                                                                                                                        
        host (str): хост базы данных                                                                                                                                                                                               
        table_name (str): название создаваемой таблицы                                                                                                                                                                             
        columns_sql (str): SQL-описание столбцов таблицы                                                                                                                                                                           
                                                                                                                                                                                                                                   
        Возвращаемое значение:                                                                                                                                                                                                     
        None                                                                                                                                                                                                                       
                                                                                                                                                                                                                                   
        Поднимает:                                                                                                                                                                                                                 
        Exception: при ошибке подключения или создания таблицы                                                                                                                                                                     
                                                                                                                                                                                                                                   
#### save_company_to_db                                                                                                                                             
* Сохраняет данные компании в базу данных.                                                                                                                                                                                   
                                                                                                                                                                                                                                   
        Параметры:                                                                                                                                                                                                                 
        company_data (Dict[str, Any]): словарь с данными компании                                                                                                                                                                  
        user (str): имя пользователя для подключения                                                                                                                                                                               
        password (str): пароль пользователя                                                                                                                                                                                        
                                                                                                                                                                                                                                   
        Возвращаемое значение:                                                                                                                                                                                                     
        bool: True - если данные успешно сохранены, False - при ошибке                                                                                                                                                             
                                                                                                                                                                                                                                   
        Поднимает:                                                                                                                                                                                                                 
        Exception: при ошибке подключения или сохранения данных                                                                                                                                                                    
                                                                                                                                                                                                                                   
#### save_vacancies_to_db
* Сохраняет данные вакансий в базу данных.                                                                                                                                                                                   
                                                                                                                                                                                                                                   
        Параметры:                                                                                                                                                                                                                 
        vacancies_data (Dict[str, Any]): словарь с данными вакансий                                                                                                                                                                
        user (str): имя пользователя для подключения                                                                                                                                                                               
        password (str): пароль пользователя                                                                                                                                                                                        
                                                                                                                                                                                                                                   
        Возвращаемое значение:                                                                                                                                                                                                     
        bool: True - если данные успешно сохранены, False - при ошибке                                                                                                                                                             
                                                                                                                                                                                                                                   
        Поднимает:                                                                                                                                                                                                                 
        Exception: при ошибке подключения или сохранения данных                                                                                                                                                                    
                                                              
## src.db_manager
### Класс DBManager
* Класс для взаимодействия с базой данных PostgreSQL.                                                                                                                                                                        
        
        Атрибуты:                                                                                                                                                                                                                  
        db_name (str): название базы данных                                                                                                                                                                                    
        user (str): имя пользователя для подключения                                                                                                                                                                           
        password (str): пароль пользователя                                                                                                                                                                                    
        host (str): хост базы данных (по умолчанию '127.0.0.1')                                                                                                                                                                
        port (str): порт подключения (по умолчанию '5432')                                                                                                                                                                     
        connection (Optional[connection]): объект подключения к БД                                                                                                                                                             
        cursor (Optional[cursor]): объект курсора                                                                                                                                                                              
 
### Методы

#### __init__ 
* Инициализация объекта DBManager.                                                                                                                                                                                       

        Параметры:                                                                                                                                                                                                             
        db_name (str): название базы данных                                                                                                                                                                                
        user (str): имя пользователя для подключения                                                                                                                                                                       
        password (str): пароль пользователя                                                                                                                                                                                
        host (str, optional): хост базы данных. По умолчанию '127.0.0.1'                                                                                                                                                   
        port (str, optional): порт подключения. По умолчанию '5432'                                                                                                                                                        
                                                                                                                                                                                                                             
#### close                                                                                                                                                                                                        
* Метод для отключения от базы данных.                                                                                                                                                                                   
* Закрывает соединение с базой данных и обнуляет курсор.                                                                                                                                                                 
                                                                                                                                                                                                                          
#### connect                                                                                                                                                                                                      
* Метод для подключения к базе данных.                                                                                                                                                                                   
* Подключается к PostgreSQL базе данных с использованием заданных параметров. Создает соединение и курсор.                                                                                                                                                                      
* Вызывает исключение OperationalError в случае неудачи.                                                                                                                                                                 

#### get_all_vacancies
* Метод для получения списка всех вакансий с указанием названия компании, названия вакансии, 
зарплаты и ссылки на вакансию.                                                                                                                                                                      
                                                                                                                                                                                                                             
      Возвращает:                                                                                                                                                                                                            
      Список словарей, где каждый словарь содержит:                                                                                                                                                                          
      - company_name (str): название компании                                                                                                                                                                                
      - vacancy_name (str): название вакансии                                                                                                                                                                                
      - salary_min (Optional[str]): минимальная зарплата или 'Не указано'                                                                                                                                                    
      - salary_max (Optional[str]): максимальная зарплата или 'Не указано'                                                                                                                                                   
      - vacancy_url (str): ссылка на вакансию                                                                                                                                                                                
                                                                                                                                                                                                                             
      Поднимает:                                                                                                                                                                                                             
      Exception: при ошибке выполнения SQL-запроса                                                                                                                                                                           
                                                                                                                                                                                                                             
#### get_avg_salary
* Метод для получения средней зарплаты по вакансиям.                                                                                                                                                                     
                                                                                                                                                                                                                             
      Возвращает:                                                                                                                                                                                                            
      Словарь со следующими ключами:                                                                                                                                                                                         
      - avg_min (Optional[int]): средняя минимальная зарплата                                                                                                                                                                
      - avg_max (Optional[int]): средняя максимальная зарплата                                                                                                                                                               
      - avg_salary (Optional[int]): средняя зарплата                                                                                                                                                                         
                                                                                                                                                                                                                             
      Поднимает:                                                                                                                                                                                                             
      Exception: если нет активного подключения к базе данных                                                                                                                                                                
                                                                                                                                                                                                                             
#### get_companies_and_vacancies_count                                                                                                                                                            
* Метод для получения списка всех компаний и количества вакансий у каждой компании.                                                                                                                                      
                                                                                                                                                                                                                             
      Возвращает:                                                                                                                                                                                                            
      Список словарей, где каждый словарь содержит:                                                                                                                                                                          
      - employer_name (str): название компании                                                                                                                                                                               
      - employer_open_vacancy (str): количество открытых вакансий                                                                                                                                                            
                                                                                                                                                                                                                             
      Поднимает:                                                                                                                                                                                                             
      Exception: если нет активного подключения к базе данных                                                                                                                                                                
                                                                                                                                                                                                                             
#### get_vacancies_with_higher_salary
* Метод получает список всех вакансий, у которых зарплата выше средней по всем вакансиям.                                                                                                                                
                                                                                                                                                                                                                             
      Возвращает:                                                                                                                                                                                                            
      Список словарей, где каждый словарь содержит:                                                                                                                                                                          
      - vacancy_name (str): название вакансии                                                                                                                                                                                
      - requirement_vacancy (str): описание вакансии                                                                                                                                                                         
      - salary_min (Optional[int]): минимальная зарплата                                                                                                                                                                     
      - salary_max (Optional[int]): максимальная зарплата                                                                                                                                                                    
      - avg_salary (Optional[int]): средняя зарплата по вакансии                                                                                                                                                             
                                                                                                                                                                                                                             
      Поднимает:                                                                                                                                                                                                             
      Exception: при ошибке выполнения SQL-запроса                                                                                                                                                                           
                                                                                                                                                                                                                             
#### get_vacancies_with_keyword
* Метод получает список всех вакансий, в названии которых содержатся переданные в метод слова.                                                                                                                           
                                                                                                                                                                                                                             
      Параметры:                                                                                                                                                                                                             
      keyword (str): искомое слово                                                                                                                                                                                           
                                                                                                                                                                                                                             
      Возвращает:                                                                                                                                                                                                            
      Список словарей, где каждый словарь содержит:                                                                                                                                                                          
      - vacancy_id (int): ID вакансии                                                                                                                                                                                        
      - vacancy_name (str): наименование вакансии                                                                                                                                                                            
      - requirement_vacancy (str): описание вакансии                                                                                                                                                                         
      - salary_min (Optional[int]): минимальная зарплата                                                                                                                                                                     
      - salary_max (Optional[int]): максимальная зарплата                                                                                                                                                                    
                                                                                                                                                                                                                             
      Поднимает:                                                                                                                                                                                                             
      Exception: при ошибке выполнения SQL-запроса                                                                                                                                                                           
